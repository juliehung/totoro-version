mock-data-generator:
    image: python:3.7-stretch
    script:
        - pip install --no-cache-dir -r schedule/requirements.txt
        - python schedule/mock_data_generator.py
        - git remote set-url origin https://gitlab-ci-token:$CI_PUSH_TOKEN@gitlab.com/$CI_PROJECT_PATH.git
        - git config --global user.email $GITLAB_USER_EMAIL
        - git config --global user.name $GITLAB_USER_NAME
        - git stash save
        - git checkout master
        - git checkout stash -- .
        - git add src/main/resources/config/liquibase/appointments.csv
        - git add src/main/resources/config/liquibase/registrations.csv
        - git commit -m 'Modify mock data from CI runner'
        - git push origin master
    only:
        - schedules
