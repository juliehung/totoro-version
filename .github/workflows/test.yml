name: "Test workflow"

on:
    push:
        branches:
            - new-cicd
    pull_request:

jobs:
#    STEP1:
#        uses: dentallio/totoro-version/.github/workflows/combine-web-and-server.yml@master
#        with:
#            milestone: "milestone-1.32"
#        secrets:
#            hisGcpProjectId: ${{ secrets.HIS_GCP_PROJECT_ID }}
#            hisGcpServiceKey: ${{ secrets.HIS_GCP_SERVICE_KEY }}

#    STEP2:
#        needs: [ STEP1 ]
#        uses: dentallio/totoro-version/.github/workflows/send-slack-notification.yml@master
#        with:
#            content: Test reusable workflow complex content
#        secrets:
#            slackQaChannelHook: ${{ secrets.SLACK_QA_CHANNEL_HOOK }}

#    STEP3:
#        uses: dentallio/totoro-version/.github/workflows/send-slack-notification.yml@master
#        with:
#            content: Test reusable workflow complex content
#            url: "http://dev.dentall.site:8001/servers/8083/operation"
#            warFileName: ""
#        secrets:
#            slackQaChannelHook: ${{ secrets.SLACK_QA_CHANNEL_HOOK }}

#    STEP4COPY:
#        uses: dentallio/totoro-version/.github/workflows/init-milestone.yml@master
#        with:
#            content: "test content"
#            currentMilestone: "milestone-1.33"
#            dependedMilestone: "milestone-1.32"
#        secrets:
#            hisGcpProjectId: ${{ secrets.HIS_GCP_PROJECT_ID }}
#            hisGcpServiceKey: ${{ secrets.HIS_GCP_SERVICE_KEY }}
#            totoroVersionAccessToken: ${{ secrets.TOTORO_VERSION_ACCESS }}
    STEP51:
        runs-on: ubuntu-18.04
        steps:
            - name: test
              run: echo hello world > test

    STEP52:
        needs: [ STEP51 ]
        uses: dentallio/totoro-version/.github/workflows/copy-file-to-remote-machine.yml@master
        with:
            remoteHost: dev.dentall.site
            remoteUser: dentallio
            remotePath: /home/dentallio
            sourcePath: ./test
        secrets:
            remoteMachineToken: ${{ secrets.HIS_LOCAL_DEV_MACHINE_KEY }}

